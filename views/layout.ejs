<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Docker Logs Viewer</title>
  <link href="https://cdn.jsdelivr.net/npm/daisyui@4.12.14/dist/full.min.css" rel="stylesheet" type="text/css" />
  <script src="https://cdn.tailwindcss.com"></script>
  <%- include('partials/styles') %>
</head>
<body class="bg-gray-100">
  <div class="drawer lg:drawer-open">
    <input id="my-drawer-2" type="checkbox" class="drawer-toggle" />
    <div class="drawer-content flex flex-col p-4">
      <label for="my-drawer-2" class="btn btn-primary drawer-button lg:hidden mb-4">Open Menu</label>
      <%- body %>
    </div> 
    <div class="drawer-side">
      <label for="my-drawer-2" class="drawer-overlay"></label> 
      <ul class="menu p-4 w-52 min-h-full bg-base-200 text-base-content">
        <li><a href="/watcher" class="<%= path === '/watcher' ? 'active' : '' %>">Watcher</a></li>
        
        <!-- Settings 階層式選單 -->
        <li>
          <details <%= path.startsWith('/settings') ? 'open' : '' %>>
            <summary>Settings <%= user ? `(${user.role})` : '' %></summary>
            <% console.log('Layout render user:', user); %>  <!-- EJS 除錯輸出 -->
            <ul>
              <% if (user && user.role === 'admin') { %>
                <li>
                  <a href="/settings/new">New Container</a>
                </li>
                <li>
                  <a href="/settings/modify">Modify Container</a>
                </li>
                <li>
                  <a href="/settings/operators">管理子帳號</a>
                </li>
              <% } %>
            </ul>
          </details>
        </li>
        
        <li><a href="/logout" onclick="return confirm('確定要登出？')">Logout</a></li>
      </ul>
    </div>
  </div>
</body>
</html>
